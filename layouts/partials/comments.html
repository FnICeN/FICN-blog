<script
  src="https://giscus.app/client.js"
  data-repo="FnICeN/FICN-blog"
  data-repo-id="R_kgDONaoNsA"
  data-category="Announcements"
  data-category-id="DIC_kwDONaoNsM4CwTY0"
  data-mapping="pathname"
  data-strict="0"
  data-reactions-enabled="1"
  data-emit-metadata="0"
  data-input-position="bottom"
  data-theme="preferred_color_scheme"
  data-lang="zh-CN"
  crossorigin="anonymous"
  async
></script>

<script>
function setGiscusTheme(theme) {
  const iframe = document.querySelector('iframe.giscus-frame');
  if (!iframe) return;
  iframe.contentWindow.postMessage({
    giscus: {
      setConfig: {
        theme: theme
      }
    }
  }, 'https://giscus.app');
}

function getCurrentTheme() {
  return document.body.classList.contains('dark') ? 'dark' : 'light';
}

// 监听 body 的 class 变化
const observer = new MutationObserver(function() {
  setGiscusTheme(getCurrentTheme());
});
observer.observe(document.body, { attributes: true, attributeFilter: ['class'] });

// 页面加载后同步一次，确保初始状态正确
window.addEventListener('DOMContentLoaded', function() {
  setTimeout(() => {
    setGiscusTheme(getCurrentTheme());
  }, 500);
});
</script>

